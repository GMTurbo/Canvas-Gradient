<html>
    <head>
        <title>Linear Gradient Test</title>
        <script type="text/javascript">
			
			var width, height, drawing; 
			
			var canvas;
			
			var ctx, grad;
			
			var timer = null;
			
			var step = 0, step2 = 255, step3=128, dir1 = 1, dir2 = -1, dir3=1, angle = 0, startAngle = 0, length, opacity = 1;
			
			var takeStep = function(){
				step += dir1*0.25;
				step2 += dir2*0.25;
				step3 += dir3*0.25;
				if(step > 255 || step < 0){
					step > 255 ? dir1 = -1 : dir1 = 1;
					step += dir1*0.5;
				}
				if(step2 < 0 || step2 > 255){
					step2 > 255 ? dir2 = -1 : dir2 = 1;
					step2 += dir2*0.5;
				}
				if(step3 < 0 || step3 > 255){
					step3 > 255 ? dir3 = -1 : dir3 = 1;
					step3 += dir3*0.5;
				}
			}
			
			var toRads = function(degs){ return degs * Math.PI/180.0;}
			var toDegs= function(rads){ return rads * 180.0/Math.PI;}
			
			function randomFromTo(from, to){
			       return Math.floor(Math.random() * (to - from + 1) + from);
			    }
			
			function init(){
				
				drawing = true;
				
				width = window.innerWidth*0.95;
				
				height = window.innerHeight*0.95;
				
				length = Math.pow(width*width + height*height, 0.5);
				
				startAngle = toDegs(Math.atan(-width/2, height/2));
				
				canvas = document.getElementById("canvas");
				canvas.width = width;
				canvas.height = height;

				ctx = canvas.getContext("2d"), 
				
				grad = ctx.createLinearGradient(0, 0, canvas.width, canvas.height);
				
				setInterval("draw()", 33);
				
			}
			
			document.onkeypress = function(event){
				switch(event.keyCode){
					case 32:
						drawing = !drawing;
					break;
				}
			}
			
            function draw() {
				if(drawing){
 					clearCanvas(ctx, canvas);
                // set up gradient

					grad = ctx.createLinearGradient(-length*Math.sin(toRads(angle)), -length*Math.cos(toRads(angle)), length*Math.sin(toRads(angle)), length*Math.cos(toRads(angle)) );
					
					//(step - step2)
					grad.addColorStop(0, 'rgba(' + Math.round(255-step) + ',' +   
				                       Math.round(255-step2) + ',' + Math.round(255-step3) + ',' + opacity + ')');
					takeStep();
					grad.addColorStop(0.2, 'rgba(' + Math.round(255-step) + ',' +   
				                     Math.round(255-step2) + ',' + Math.round(255-step3) +  ',' + opacity + ')');
					takeStep();
                	grad.addColorStop(0.5, 'rgba(' + Math.round(step) + ',' +   
				                       Math.round(255-step2) + ',' + Math.round(255-step3) +  ',' + opacity + ')');
					//takeStep();
					//grad.addColorStop(0.6, 'rgba(' + Math.round(255-step) + ',' +   
				    //                Math.round(255-step2) + ',' + Math.round(255-step3) + ',' + opacity + ')');
					takeStep();
                	grad.addColorStop(0.8, 'rgba(' + Math.round(255-step) + ',' +   
				                      Math.round(255-step2) + ',' + Math.round(step3) + ',' + opacity + ')');
					takeStep();
                	grad.addColorStop(1, 'rgba(' + Math.round(step) + ',' +   
				                       Math.round(step2) + ',' + Math.round(step3) + ',' + opacity + ')');

                	ctx.fillStyle = grad;
                	ctx.fillRect(0, 0, width, height);

					angle+=0.5;
					if(angle>359 + startAngle){
						angle = startAngle;
					}
				}
				
            }

			function clearCanvas(context, canvas) {
			  context.clearRect(0, 0, width, height);
			  var w = canvas.width;
			  canvas.width = 1;
			  canvas.width = w;
			}
			
			function draw2(){
				var ctx = document.getElementById('canvas').getContext('2d');  
				  for (var i=0;i<26;i++){  
				    for (var j=0;j<26;j++){  
				      ctx.fillStyle = 'rgb(' + Math.floor(255-6.5*i) + ',' +   
				                       Math.floor(255-6.5*j) + ',0)';  
				      ctx.fillRect(j*25,i*25,25,25);  
				    }  
				  }
			}
			
        </script>
    </head>
    <body onload="init()">
    <canvas id="canvas"></canvas>
</body>
</html>